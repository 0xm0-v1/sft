function Nt(t){return(t||"").toLowerCase().trim().replace(/\s+/g," ")}function ke(t){let e=Nt(t),n=e.match(/(\d+)\s*cost/),i=n?Number(n[1]):null,o=e.replace(/(\d+)\s*cost/g,"").split(" ").filter(Boolean);return{costFilter:i,terms:o}}function Re({searchText:t,unitCost:e,isUnlockable:n,selectedCosts:i,queryCost:o,terms:r,unlockOnly:s}){let c=(i.size===0||i.has(e))&&(o===null||Number(e)===o),a=!s||n,f=r.every(l=>t.includes(l));return c&&a&&f}function _t({search:t,unit:e,cost:n,textContent:i}){let o=[t||"",e||"",n||"",(i||"").replace(/\s+/g," ")];return Nt(o.join(" "))}function Vt(t,{query:e,selectedCosts:n,unlockOnly:i}){let{costFilter:o,terms:r}=ke(e),s=[],c=[];for(let{el:a,text:f}of t)Re({searchText:f,unitCost:a.dataset.cost,isUnlockable:a.dataset.unlock==="true",selectedCosts:n,queryCost:o,terms:r,unlockOnly:i})?s.push(a):c.push(a);return{visible:s,hidden:c,count:s.length}}function Ht(t={}){let e={query:"",selectedCosts:new Set,unlockOnly:!1,...t},n=new Set;function i(){return{...e,selectedCosts:new Set(e.selectedCosts)}}function o(l){let u=i();e={...e,...l};for(let m of n)m(i(),u)}function r(l){return n.add(l),()=>n.delete(l)}function s(l){let u=new Set(e.selectedCosts);l===""?u.clear():u.has(l)?u.delete(l):u.add(l),o({selectedCosts:u})}function c(l){o({query:l})}function a(){o({unlockOnly:!e.unlockOnly})}function f(){o({query:"",selectedCosts:new Set,unlockOnly:!1})}return{getState:i,setState:o,subscribe:r,toggleCost:s,setQuery:c,toggleUnlockOnly:a,reset:f}}function $t(t,e){return Array.from(t).map(n=>({el:n,text:e({search:n.dataset.search||"",unit:n.dataset.unit||"",cost:n.dataset.cost||"",textContent:n.textContent||""})}))}var H={searchInput:"#search-input",searchWrapper:"#search-wrapper",searchClearBtn:"#search-clear",searchResults:"#search-results",costFiltersContainer:"#cost-filters",unitsGrid:"#units-grid",costFilterBtn:'[data-js="cost-filter"]',unlockFilterBtn:'[data-js="unlock-filter"]',unitCard:'[data-js="unit-card"]',tooltip:'[data-js="tooltip"]'},L={hasValue:"data-state-has-value",active:"data-state-active",hidden:"data-state-hidden",locked:"data-state-locked",visible:"data-state-visible",locking:"data-state-locking"};function qt(){let t={input:document.querySelector(H.searchInput),wrapper:document.querySelector(H.searchWrapper),clearBtn:document.querySelector(H.searchClearBtn),resultsEl:document.querySelector(H.searchResults),costFilters:Array.from(document.querySelectorAll(H.costFilterBtn)),unlockFilter:document.querySelector(H.unlockFilterBtn),cards:Array.from(document.querySelectorAll(H.unitCard))};if(!t.input||t.cards.length===0){console.warn("Search filter: Missing required DOM elements");return}let e=t.input.closest("form");e&&e.addEventListener("submit",o=>o.preventDefault());let n=Ht(),i=$t(t.cards,_t);n.subscribe(o=>{jt(o,i,t),zt(o,t)}),Le(t,n),jt(n.getState(),i,t),zt(n.getState(),t)}function jt(t,e,n){let{visible:i,hidden:o,count:r}=Vt(e,{query:t.query,selectedCosts:t.selectedCosts,unlockOnly:t.unlockOnly});for(let s of i)s.removeAttribute(L.hidden),s.hidden=!1;for(let s of o)s.setAttribute(L.hidden,"true"),s.hidden=!0,Fe(s);De(n.resultsEl,r)}function zt(t,e){e.wrapper&&(t.query?e.wrapper.setAttribute(L.hasValue,"true"):e.wrapper.removeAttribute(L.hasValue));for(let n of e.costFilters){let i=n.dataset.cost||"";(i===""?t.selectedCosts.size===0:t.selectedCosts.has(i))?(n.setAttribute(L.active,"true"),n.setAttribute("aria-pressed","true")):(n.removeAttribute(L.active),n.setAttribute("aria-pressed","false"))}e.unlockFilter&&(t.unlockOnly?(e.unlockFilter.setAttribute(L.active,"true"),e.unlockFilter.setAttribute("aria-pressed","true")):(e.unlockFilter.removeAttribute(L.active),e.unlockFilter.setAttribute("aria-pressed","false")))}function Le(t,e){let{input:n,clearBtn:i,costFilters:o,unlockFilter:r}=t;n.addEventListener("input",()=>{e.setQuery(n.value)}),i&&i.addEventListener("click",()=>{n.value="",n.focus(),e.reset()});for(let s of o)s.addEventListener("click",()=>{e.toggleCost(s.dataset.cost||"")});r&&r.addEventListener("click",()=>{e.toggleUnlockOnly()}),window.addEventListener("keydown",s=>{Pe(s,n)},!0)}function Pe(t,e){var i;if(((i=t.key)==null?void 0:i.toLowerCase())==="f"&&(t.ctrlKey||t.metaKey)){t.preventDefault(),document.activeElement===e?e.blur():(e.focus(),e.select());return}t.key==="Escape"&&document.activeElement===e&&(t.preventDefault(),e.blur())}function De(t,e){if(!t)return;let n=e===1?"result":"results";t.textContent=`${e} ${n}`}function Fe(t){let e=t.querySelector(H.tooltip);e&&(e.removeAttribute(L.locked),e.removeAttribute(L.visible),e.removeAttribute(L.locking),e.style.display="none")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",qt):qt();var X=Math.min,T=Math.max,ft=Math.round;var P=t=>({x:t,y:t}),Ie={left:"right",right:"left",bottom:"top",top:"bottom"},Be={start:"end",end:"start"};function Lt(t,e,n){return T(t,X(e,n))}function J(t,e){return typeof t=="function"?t(e):t}function W(t){return t.split("-")[0]}function Z(t){return t.split("-")[1]}function Pt(t){return t==="x"?"y":"x"}function Dt(t){return t==="y"?"height":"width"}var Me=new Set(["top","bottom"]);function F(t){return Me.has(W(t))?"y":"x"}function Ft(t){return Pt(F(t))}function Ut(t,e,n){n===void 0&&(n=!1);let i=Z(t),o=Ft(t),r=Dt(o),s=o==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[r]>e.floating[r]&&(s=at(s)),[s,at(s)]}function Gt(t){let e=at(t);return[wt(t),e,wt(e)]}function wt(t){return t.replace(/start|end/g,e=>Be[e])}var Yt=["left","right"],Xt=["right","left"],We=["top","bottom"],Ne=["bottom","top"];function _e(t,e,n){switch(t){case"top":case"bottom":return n?e?Xt:Yt:e?Yt:Xt;case"left":case"right":return e?We:Ne;default:return[]}}function Kt(t,e,n,i){let o=Z(t),r=_e(W(t),n==="start",i);return o&&(r=r.map(s=>s+"-"+o),e&&(r=r.concat(r.map(wt)))),r}function at(t){return t.replace(/left|right|bottom|top/g,e=>Ie[e])}function Ve(t){return{top:0,right:0,bottom:0,left:0,...t}}function Qt(t){return typeof t!="number"?Ve(t):{top:t,right:t,bottom:t,left:t}}function U(t){let{x:e,y:n,width:i,height:o}=t;return{width:i,height:o,top:n,left:e,right:e+i,bottom:n+o,x:e,y:n}}function Jt(t,e,n){let{reference:i,floating:o}=t,r=F(e),s=Ft(e),c=Dt(s),a=W(e),f=r==="y",l=i.x+i.width/2-o.width/2,u=i.y+i.height/2-o.height/2,m=i[c]/2-o[c]/2,d;switch(a){case"top":d={x:l,y:i.y-o.height};break;case"bottom":d={x:l,y:i.y+i.height};break;case"right":d={x:i.x+i.width,y:u};break;case"left":d={x:i.x-o.width,y:u};break;default:d={x:i.x,y:i.y}}switch(Z(e)){case"start":d[s]-=m*(n&&f?-1:1);break;case"end":d[s]+=m*(n&&f?-1:1);break}return d}var Zt=async(t,e,n)=>{let{placement:i="bottom",strategy:o="absolute",middleware:r=[],platform:s}=n,c=r.filter(Boolean),a=await(s.isRTL==null?void 0:s.isRTL(e)),f=await s.getElementRects({reference:t,floating:e,strategy:o}),{x:l,y:u}=Jt(f,i,a),m=i,d={},h=0;for(let g=0;g<c.length;g++){let{name:p,fn:w}=c[g],{x:y,y:x,data:S,reset:b}=await w({x:l,y:u,initialPlacement:i,placement:m,strategy:o,middlewareData:d,rects:f,platform:s,elements:{reference:t,floating:e}});l=y!=null?y:l,u=x!=null?x:u,d={...d,[p]:{...d[p],...S}},b&&h<=50&&(h++,typeof b=="object"&&(b.placement&&(m=b.placement),b.rects&&(f=b.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:o}):b.rects),{x:l,y:u}=Jt(f,m,a)),g=-1)}return{x:l,y:u,placement:m,strategy:o,middlewareData:d}};async function yt(t,e){var n;e===void 0&&(e={});let{x:i,y:o,platform:r,rects:s,elements:c,strategy:a}=t,{boundary:f="clippingAncestors",rootBoundary:l="viewport",elementContext:u="floating",altBoundary:m=!1,padding:d=0}=J(e,t),h=Qt(d),p=c[m?u==="floating"?"reference":"floating":u],w=U(await r.getClippingRect({element:(n=await(r.isElement==null?void 0:r.isElement(p)))==null||n?p:p.contextElement||await(r.getDocumentElement==null?void 0:r.getDocumentElement(c.floating)),boundary:f,rootBoundary:l,strategy:a})),y=u==="floating"?{x:i,y:o,width:s.floating.width,height:s.floating.height}:s.reference,x=await(r.getOffsetParent==null?void 0:r.getOffsetParent(c.floating)),S=await(r.isElement==null?void 0:r.isElement(x))?await(r.getScale==null?void 0:r.getScale(x))||{x:1,y:1}:{x:1,y:1},b=U(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:y,offsetParent:x,strategy:a}):y);return{top:(w.top-b.top+h.top)/S.y,bottom:(b.bottom-w.bottom+h.bottom)/S.y,left:(w.left-b.left+h.left)/S.x,right:(b.right-w.right+h.right)/S.x}}var te=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,i;let{placement:o,middlewareData:r,rects:s,initialPlacement:c,platform:a,elements:f}=e,{mainAxis:l=!0,crossAxis:u=!0,fallbackPlacements:m,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:h="none",flipAlignment:g=!0,...p}=J(t,e);if((n=r.arrow)!=null&&n.alignmentOffset)return{};let w=W(o),y=F(c),x=W(c)===c,S=await(a.isRTL==null?void 0:a.isRTL(f.floating)),b=m||(x||!g?[at(c)]:Gt(c)),pt=h!=="none";!m&&pt&&b.push(...Kt(c,g,h,S));let ot=[c,...b],q=await yt(e,p),j=[],M=((i=r.flip)==null?void 0:i.overflows)||[];if(l&&j.push(q[w]),u){let z=Ut(o,s,S);j.push(q[z[0]],q[z[1]])}if(M=[...M,{placement:o,overflows:j}],!j.every(z=>z<=0)){var st,rt;let z=(((st=r.flip)==null?void 0:st.index)||0)+1,Rt=ot[z];if(Rt&&(!(u==="alignment"?y!==F(Rt):!1)||M.every(R=>F(R.placement)===y?R.overflows[0]>0:!0)))return{data:{index:z,overflows:M},reset:{placement:Rt}};let lt=(rt=M.filter(Y=>Y.overflows[0]<=0).sort((Y,R)=>Y.overflows[1]-R.overflows[1])[0])==null?void 0:rt.placement;if(!lt)switch(d){case"bestFit":{var ct;let Y=(ct=M.filter(R=>{if(pt){let V=F(R.placement);return V===y||V==="y"}return!0}).map(R=>[R.placement,R.overflows.filter(V=>V>0).reduce((V,Ee)=>V+Ee,0)]).sort((R,V)=>R[1]-V[1])[0])==null?void 0:ct[0];Y&&(lt=Y);break}case"initialPlacement":lt=c;break}if(o!==lt)return{reset:{placement:lt}}}return{}}}};var He=new Set(["left","top"]);async function $e(t,e){let{placement:n,platform:i,elements:o}=t,r=await(i.isRTL==null?void 0:i.isRTL(o.floating)),s=W(n),c=Z(n),a=F(n)==="y",f=He.has(s)?-1:1,l=r&&a?-1:1,u=J(e,t),{mainAxis:m,crossAxis:d,alignmentAxis:h}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return c&&typeof h=="number"&&(d=c==="end"?h*-1:h),a?{x:d*l,y:m*f}:{x:m*f,y:d*l}}var ee=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,i;let{x:o,y:r,placement:s,middlewareData:c}=e,a=await $e(e,t);return s===((n=c.offset)==null?void 0:n.placement)&&(i=c.arrow)!=null&&i.alignmentOffset?{}:{x:o+a.x,y:r+a.y,data:{...a,placement:s}}}}},ne=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){let{x:n,y:i,placement:o}=e,{mainAxis:r=!0,crossAxis:s=!1,limiter:c={fn:p=>{let{x:w,y}=p;return{x:w,y}}},...a}=J(t,e),f={x:n,y:i},l=await yt(e,a),u=F(W(o)),m=Pt(u),d=f[m],h=f[u];if(r){let p=m==="y"?"top":"left",w=m==="y"?"bottom":"right",y=d+l[p],x=d-l[w];d=Lt(y,d,x)}if(s){let p=u==="y"?"top":"left",w=u==="y"?"bottom":"right",y=h+l[p],x=h-l[w];h=Lt(y,h,x)}let g=c.fn({...e,[m]:d,[u]:h});return{...g,data:{x:g.x-n,y:g.y-i,enabled:{[m]:r,[u]:s}}}}}};var ie=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,i;let{placement:o,rects:r,platform:s,elements:c}=e,{apply:a=()=>{},...f}=J(t,e),l=await yt(e,f),u=W(o),m=Z(o),d=F(o)==="y",{width:h,height:g}=r.floating,p,w;u==="top"||u==="bottom"?(p=u,w=m===(await(s.isRTL==null?void 0:s.isRTL(c.floating))?"start":"end")?"left":"right"):(w=u,p=m==="end"?"top":"bottom");let y=g-l.top-l.bottom,x=h-l.left-l.right,S=X(g-l[p],y),b=X(h-l[w],x),pt=!e.middlewareData.shift,ot=S,q=b;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(q=x),(i=e.middlewareData.shift)!=null&&i.enabled.y&&(ot=y),pt&&!m){let M=T(l.left,0),st=T(l.right,0),rt=T(l.top,0),ct=T(l.bottom,0);d?q=h-2*(M!==0||st!==0?M+st:T(l.left,l.right)):ot=g-2*(rt!==0||ct!==0?rt+ct:T(l.top,l.bottom))}await a({...e,availableWidth:q,availableHeight:ot});let j=await s.getDimensions(c.floating);return h!==j.width||g!==j.height?{reset:{rects:!0}}:{}}}};function bt(){return typeof window!="undefined"}function G(t){return se(t)?(t.nodeName||"").toLowerCase():"#document"}function O(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function I(t){var e;return(e=(se(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function se(t){return bt()?t instanceof Node||t instanceof O(t).Node:!1}function C(t){return bt()?t instanceof Element||t instanceof O(t).Element:!1}function D(t){return bt()?t instanceof HTMLElement||t instanceof O(t).HTMLElement:!1}function oe(t){return!bt()||typeof ShadowRoot=="undefined"?!1:t instanceof ShadowRoot||t instanceof O(t).ShadowRoot}var qe=new Set(["inline","contents"]);function tt(t){let{overflow:e,overflowX:n,overflowY:i,display:o}=E(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!qe.has(o)}var je=new Set(["table","td","th"]);function re(t){return je.has(G(t))}var ze=[":popover-open",":modal"];function ut(t){return ze.some(e=>{try{return t.matches(e)}catch(n){return!1}})}var Ye=["transform","translate","scale","rotate","perspective"],Xe=["transform","translate","scale","rotate","perspective","filter"],Ue=["paint","layout","strict","content"];function vt(t){let e=At(),n=C(t)?E(t):t;return Ye.some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||Xe.some(i=>(n.willChange||"").includes(i))||Ue.some(i=>(n.contain||"").includes(i))}function ce(t){let e=N(t);for(;D(e)&&!K(e);){if(vt(e))return e;if(ut(e))return null;e=N(e)}return null}function At(){return typeof CSS=="undefined"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}var Ge=new Set(["html","body","#document"]);function K(t){return Ge.has(G(t))}function E(t){return O(t).getComputedStyle(t)}function dt(t){return C(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function N(t){if(G(t)==="html")return t;let e=t.assignedSlot||t.parentNode||oe(t)&&t.host||I(t);return oe(e)?e.host:e}function le(t){let e=N(t);return K(e)?t.ownerDocument?t.ownerDocument.body:t.body:D(e)&&tt(e)?e:le(e)}function xt(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);let o=le(t),r=o===((i=t.ownerDocument)==null?void 0:i.body),s=O(o);if(r){let c=Tt(s);return e.concat(s,s.visualViewport||[],tt(o)?o:[],c&&n?xt(c):[])}return e.concat(o,xt(o,[],n))}function Tt(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function de(t){let e=E(t),n=parseFloat(e.width)||0,i=parseFloat(e.height)||0,o=D(t),r=o?t.offsetWidth:n,s=o?t.offsetHeight:i,c=ft(n)!==r||ft(i)!==s;return c&&(n=r,i=s),{width:n,height:i,$:c}}function me(t){return C(t)?t:t.contextElement}function et(t){let e=me(t);if(!D(e))return P(1);let n=e.getBoundingClientRect(),{width:i,height:o,$:r}=de(e),s=(r?ft(n.width):n.width)/i,c=(r?ft(n.height):n.height)/o;return(!s||!Number.isFinite(s))&&(s=1),(!c||!Number.isFinite(c))&&(c=1),{x:s,y:c}}var Ke=P(0);function he(t){let e=O(t);return!At()||!e.visualViewport?Ke:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Qe(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==O(t)?!1:e}function mt(t,e,n,i){e===void 0&&(e=!1),n===void 0&&(n=!1);let o=t.getBoundingClientRect(),r=me(t),s=P(1);e&&(i?C(i)&&(s=et(i)):s=et(t));let c=Qe(r,n,i)?he(r):P(0),a=(o.left+c.x)/s.x,f=(o.top+c.y)/s.y,l=o.width/s.x,u=o.height/s.y;if(r){let m=O(r),d=i&&C(i)?O(i):i,h=m,g=Tt(h);for(;g&&i&&d!==h;){let p=et(g),w=g.getBoundingClientRect(),y=E(g),x=w.left+(g.clientLeft+parseFloat(y.paddingLeft))*p.x,S=w.top+(g.clientTop+parseFloat(y.paddingTop))*p.y;a*=p.x,f*=p.y,l*=p.x,u*=p.y,a+=x,f+=S,h=O(g),g=Tt(h)}}return U({width:l,height:u,x:a,y:f})}function Ot(t,e){let n=dt(t).scrollLeft;return e?e.left+n:mt(I(t)).left+n}function ge(t,e){let n=t.getBoundingClientRect(),i=n.left+e.scrollLeft-Ot(t,n),o=n.top+e.scrollTop;return{x:i,y:o}}function Je(t){let{elements:e,rect:n,offsetParent:i,strategy:o}=t,r=o==="fixed",s=I(i),c=e?ut(e.floating):!1;if(i===s||c&&r)return n;let a={scrollLeft:0,scrollTop:0},f=P(1),l=P(0),u=D(i);if((u||!u&&!r)&&((G(i)!=="body"||tt(s))&&(a=dt(i)),D(i))){let d=mt(i);f=et(i),l.x=d.x+i.clientLeft,l.y=d.y+i.clientTop}let m=s&&!u&&!r?ge(s,a):P(0);return{width:n.width*f.x,height:n.height*f.y,x:n.x*f.x-a.scrollLeft*f.x+l.x+m.x,y:n.y*f.y-a.scrollTop*f.y+l.y+m.y}}function Ze(t){return Array.from(t.getClientRects())}function tn(t){let e=I(t),n=dt(t),i=t.ownerDocument.body,o=T(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),r=T(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight),s=-n.scrollLeft+Ot(t),c=-n.scrollTop;return E(i).direction==="rtl"&&(s+=T(e.clientWidth,i.clientWidth)-o),{width:o,height:r,x:s,y:c}}var ae=25;function en(t,e){let n=O(t),i=I(t),o=n.visualViewport,r=i.clientWidth,s=i.clientHeight,c=0,a=0;if(o){r=o.width,s=o.height;let l=At();(!l||l&&e==="fixed")&&(c=o.offsetLeft,a=o.offsetTop)}let f=Ot(i);if(f<=0){let l=i.ownerDocument,u=l.body,m=getComputedStyle(u),d=l.compatMode==="CSS1Compat"&&parseFloat(m.marginLeft)+parseFloat(m.marginRight)||0,h=Math.abs(i.clientWidth-u.clientWidth-d);h<=ae&&(r-=h)}else f<=ae&&(r+=f);return{width:r,height:s,x:c,y:a}}var nn=new Set(["absolute","fixed"]);function on(t,e){let n=mt(t,!0,e==="fixed"),i=n.top+t.clientTop,o=n.left+t.clientLeft,r=D(t)?et(t):P(1),s=t.clientWidth*r.x,c=t.clientHeight*r.y,a=o*r.x,f=i*r.y;return{width:s,height:c,x:a,y:f}}function fe(t,e,n){let i;if(e==="viewport")i=en(t,n);else if(e==="document")i=tn(I(t));else if(C(e))i=on(e,n);else{let o=he(t);i={x:e.x-o.x,y:e.y-o.y,width:e.width,height:e.height}}return U(i)}function pe(t,e){let n=N(t);return n===e||!C(n)||K(n)?!1:E(n).position==="fixed"||pe(n,e)}function sn(t,e){let n=e.get(t);if(n)return n;let i=xt(t,[],!1).filter(c=>C(c)&&G(c)!=="body"),o=null,r=E(t).position==="fixed",s=r?N(t):t;for(;C(s)&&!K(s);){let c=E(s),a=vt(s);!a&&c.position==="fixed"&&(o=null),(r?!a&&!o:!a&&c.position==="static"&&!!o&&nn.has(o.position)||tt(s)&&!a&&pe(t,s))?i=i.filter(l=>l!==s):o=c,s=N(s)}return e.set(t,i),i}function rn(t){let{element:e,boundary:n,rootBoundary:i,strategy:o}=t,s=[...n==="clippingAncestors"?ut(e)?[]:sn(e,this._c):[].concat(n),i],c=s[0],a=s.reduce((f,l)=>{let u=fe(e,l,o);return f.top=T(u.top,f.top),f.right=X(u.right,f.right),f.bottom=X(u.bottom,f.bottom),f.left=T(u.left,f.left),f},fe(e,c,o));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function cn(t){let{width:e,height:n}=de(t);return{width:e,height:n}}function ln(t,e,n){let i=D(e),o=I(e),r=n==="fixed",s=mt(t,!0,r,e),c={scrollLeft:0,scrollTop:0},a=P(0);function f(){a.x=Ot(o)}if(i||!i&&!r)if((G(e)!=="body"||tt(o))&&(c=dt(e)),i){let d=mt(e,!0,r,e);a.x=d.x+e.clientLeft,a.y=d.y+e.clientTop}else o&&f();r&&!i&&o&&f();let l=o&&!i&&!r?ge(o,c):P(0),u=s.left+c.scrollLeft-a.x-l.x,m=s.top+c.scrollTop-a.y-l.y;return{x:u,y:m,width:s.width,height:s.height}}function It(t){return E(t).position==="static"}function ue(t,e){if(!D(t)||E(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return I(t)===n&&(n=n.ownerDocument.body),n}function we(t,e){let n=O(t);if(ut(t))return n;if(!D(t)){let o=N(t);for(;o&&!K(o);){if(C(o)&&!It(o))return o;o=N(o)}return n}let i=ue(t,e);for(;i&&re(i)&&It(i);)i=ue(i,e);return i&&K(i)&&It(i)&&!vt(i)?n:i||ce(t)||n}var an=async function(t){let e=this.getOffsetParent||we,n=this.getDimensions,i=await n(t.floating);return{reference:ln(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function fn(t){return E(t).direction==="rtl"}var un={convertOffsetParentRelativeRectToViewportRelativeRect:Je,getDocumentElement:I,getClippingRect:rn,getOffsetParent:we,getElementRects:an,getClientRects:Ze,getDimensions:cn,getScale:et,isElement:C,isRTL:fn};var ye=ee;var xe=ne,be=te,ve=ie;var Ae=(t,e,n)=>{let i=new Map,o={platform:un,...n},r={...o.platform,_c:i};return Zt(t,e,{...o,platform:r})};var v={SHOW_DELAY:200,LOCK_DELAY:800,HIDE_DELAY:100,HIDE_TRANSITION:150,OFFSET:12,VIEWPORT_PADDING:12},_={unitCard:'[data-js="unit-card"]',tooltip:'[data-js="tooltip"]',tabButton:'[data-js="tab-button"]',tabPanel:'[data-js="tab-panel"]',tabContainer:'[data-js="tab-container"]',lockIndicator:'[data-js="lock-indicator"]',traitIcon:".trait-icon[data-icon]"},A={locked:"data-state-locked",visible:"data-state-visible",locking:"data-state-locking",active:"data-state-active"},Bt=new WeakMap,$=new WeakSet,kt=new WeakSet,B=null,ht=null,St=0,Ct=0;function k(t){return Bt.has(t)||Bt.set(t,{status:"hidden",showTimeout:null,lockTimeout:null,hideTimeout:null,isDisabled:!1,currentContainer:null}),Bt.get(t)}function Q(t,e){Object.assign(k(t),e)}function Oe(t){let e=k(t);clearTimeout(e.showTimeout),clearTimeout(e.lockTimeout),clearTimeout(e.hideTimeout),e.showTimeout=null,e.lockTimeout=null,e.hideTimeout=null}function dn(t,e){return{getBoundingClientRect(){return{width:0,height:0,x:t,y:e,top:e,left:t,right:t,bottom:e}}}}async function mn(t,e,n){let i=dn(e,n);try{let{x:o,y:r,placement:s}=await Ae(i,t,{placement:"right-start",strategy:"fixed",middleware:[ye(v.OFFSET),be({fallbackPlacements:["left-start","right-end","left-end","bottom-start","top-start"],padding:v.VIEWPORT_PADDING}),xe({padding:v.VIEWPORT_PADDING,crossAxis:!0}),ve({apply({availableWidth:c,availableHeight:a,elements:f}){Object.assign(f.floating.style,{maxWidth:`${Math.min(c,380)}px`,maxHeight:`${a}px`})},padding:v.VIEWPORT_PADDING})]});t.style.left=`${o}px`,t.style.top=`${r}px`,t.setAttribute("data-placement",s)}catch(o){let r=t.getBoundingClientRect(),s=e+v.OFFSET,c=n;s+r.width>window.innerWidth-v.VIEWPORT_PADDING&&(s=e-r.width-v.OFFSET),c+r.height>window.innerHeight-v.VIEWPORT_PADDING&&(c=window.innerHeight-r.height-v.VIEWPORT_PADDING),s=Math.max(v.VIEWPORT_PADDING,s),c=Math.max(v.VIEWPORT_PADDING,c),t.style.left=`${s}px`,t.style.top=`${c}px`}}function Se(t,e){let n=e.dataset.tabTarget;n&&(t.querySelectorAll(_.tabButton).forEach(i=>{let o=i===e;o?i.setAttribute(A.active,"true"):i.removeAttribute(A.active),i.setAttribute("aria-selected",String(o)),i.setAttribute("tabindex",o?"0":"-1")}),t.querySelectorAll(_.tabPanel).forEach(i=>{i.dataset.tabPanel===n?(i.setAttribute(A.active,"true"),i.hidden=!1):(i.removeAttribute(A.active),i.hidden=!0)}))}function hn(t){let e=t.querySelector(_.tabContainer);e&&e.addEventListener("keydown",n=>{let i=Array.from(e.querySelectorAll(_.tabButton)),o=i.indexOf(document.activeElement);if(o===-1)return;let r=o;n.key==="ArrowLeft"||n.key==="ArrowUp"?(n.preventDefault(),r=o>0?o-1:i.length-1):(n.key==="ArrowRight"||n.key==="ArrowDown")&&(n.preventDefault(),r=o<i.length-1?o+1:0),r!==o&&(i[r].focus(),Se(t,i[r]))})}function Et(t,e){let n=k(t);if(!(B||n.isDisabled)){if(clearTimeout(n.hideTimeout),n.hideTimeout=null,n.status==="visible"||n.status==="locked"){Q(t,{currentContainer:e});return}Oe(t),Q(t,{currentContainer:e}),n.showTimeout=setTimeout(()=>{B||n.isDisabled||!$.has(e)&&!kt.has(t)||(Q(t,{status:"visible"}),t.classList.remove("hidden"),t.classList.add("block"),t.setAttribute(A.locking,"true"),t.removeAttribute(A.locked),mn(t,St,Ct),requestAnimationFrame(()=>{k(t).status!=="hidden"&&t.setAttribute(A.visible,"true")}),n.lockTimeout=setTimeout(()=>Wt(t),v.LOCK_DELAY))},v.SHOW_DELAY)}}function Ce(t){let e=k(t);e.status==="hidden"||e.hideTimeout||(e.hideTimeout=setTimeout(()=>{if($.has(e.currentContainer)||kt.has(t)){e.hideTimeout=null;return}it(t,!1)},v.HIDE_DELAY))}function Mt(t){let e=k(t);clearTimeout(e.hideTimeout),e.hideTimeout=null}function it(t,e=!1){Oe(t),Q(t,{status:"hidden",currentContainer:null}),t.removeAttribute(A.visible),t.removeAttribute(A.locking),t.removeAttribute(A.locked),e?(t.classList.remove("block"),t.classList.add("hidden")):setTimeout(()=>{k(t).status==="hidden"&&(t.classList.remove("block"),t.classList.add("hidden"))},v.HIDE_TRANSITION)}function Wt(t){let e=k(t);e.status!=="hidden"&&(clearTimeout(e.lockTimeout),Q(t,{status:"locked",lockTimeout:null}),t.setAttribute(A.locked,"true"),t.removeAttribute(A.locking))}function gn(t){t.querySelectorAll(_.traitIcon).forEach(n=>{let i=n.dataset.icon;i&&(n.style.maskImage=`url('${i}')`,n.style.webkitMaskImage=`url('${i}')`)})}function pn(t,e){t.addEventListener("pointermove",n=>{St=n.clientX,Ct=n.clientY},{passive:!0}),t.addEventListener("pointerenter",n=>{St=n.clientX,Ct=n.clientY,$.add(t),Mt(e),B||Et(e,t)}),t.addEventListener("pointerleave",n=>{if($.delete(t),e.contains(n.relatedTarget)||B===t)return;let i=k(e);i.status==="visible"||i.status==="locked"?Ce(e):it(e,!0)}),t.addEventListener("pointerdown",n=>{e.contains(n.target)||n.button===0&&(t.setPointerCapture(n.pointerId),B=t,ht=n.pointerId,it(e,!0))}),t.addEventListener("pointerup",n=>{B===t&&n.pointerId===ht&&(t.releasePointerCapture(n.pointerId),B=null,ht=null,!k(e).isDisabled&&$.has(t)&&Et(e,t))}),t.addEventListener("lostpointercapture",n=>{B===t&&n.pointerId===ht&&(B=null,ht=null)}),t.addEventListener("focus",()=>{let n=t.getBoundingClientRect();St=n.right,Ct=n.top+n.height/2,$.add(t),Mt(e),Et(e,t)},!0),t.addEventListener("blur",n=>{$.delete(t),e.contains(n.relatedTarget)||it(e)},!0)}function wn(t,e){e.addEventListener("pointerenter",()=>{kt.add(e),Mt(e)}),e.addEventListener("pointerleave",n=>{kt.delete(e);let i=k(e);i.currentContainer&&i.currentContainer.contains(n.relatedTarget)||Ce(e)}),e.addEventListener("pointerdown",n=>{n.stopPropagation(),n.target.closest(_.tabButton)&&n.preventDefault(),k(e).status!=="locked"&&Wt(e)}),e.addEventListener("pointerup",n=>{n.stopPropagation()}),e.addEventListener("click",n=>{n.stopPropagation();let i=n.target.closest(_.tabButton);i&&Se(e,i)})}var gt=new WeakMap;window.TooltipManager={disable(t){let e=gt.get(t);e&&(Q(e,{isDisabled:!0}),it(e,!0))},enable(t){let e=gt.get(t);e&&(Q(e,{isDisabled:!1}),$.has(t)&&!B&&Et(e,t))},hide(t){let e=gt.get(t);e&&it(e,!0)},lock(t){let e=gt.get(t);e&&Wt(e)}};var nt=null;function yn(){return nt||(nt=document.createElement("div"),nt.id="tooltip-portal",nt.setAttribute("aria-live","polite"),document.body.appendChild(nt)),nt}function Te(){let t=document.querySelectorAll(_.unitCard),e=0;t.forEach(n=>{let i=n.querySelector(_.tooltip);if(!i)return;yn().appendChild(i),i._originalContainer=n,gt.set(n,i),i.classList.add("hidden"),i.classList.remove("block"),i.removeAttribute(A.visible),i.removeAttribute(A.locked),i.removeAttribute(A.locking),gn(i),pn(n,i),wn(n,i),hn(i),e++}),console.log("[TooltipManager] Initialized",e,"tooltips (portaled to body)")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Te):Te();
